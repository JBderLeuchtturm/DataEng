# JupyterHub Helm values for a single-user JupyterLab setup
# This file only includes schema‑valid configuration

proxy:
  # Must be random 32‑byte hex — replace with your own if re‑using
  secretToken: "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"

hub:
  # Use default SQLite on PVC — no storageClass or resources here
  db:
    type: sqlite-pvc
  config:
    JupyterHub:
      authenticator_class: "dummy"
    DummyAuthenticator:
      password: ""

singleuser:
  image:
    name: jupyter/base-notebook
    tag: lab-4.0.5

  # Storage configuration must match chart schema
  storage:
    type: dynamic
    dynamic:
      # Only the storageClass key here — no size under dynamic
      storageClass: local-path

  # CPU / memory shape
  cpu:
    guarantee: 0.5
    limit: 1

  memory:
    guarantee: 512M
    limit: 1G

  extraEnv:
    # --- MinIO ---
    MINIO_ENDPOINT: "minio.data-storage.svc.cluster.local:9005"

    MINIO_ACCESS_KEY:
      valueFrom:
        secretKeyRef:
          name: minio
          key: root-user

    MINIO_SECRET_KEY:
      valueFrom:
        secretKeyRef:
          name: minio
          key: root-password

    # --- Postgres ---
    POSTGRES_HOST: "postgres-postgresql.data-storage.svc.cluster.local"
    POSTGRES_PORT: "5432"
    POSTGRES_DB: "ds_db"

    POSTGRES_USER:
      valueFrom:
        secretKeyRef:
          name: postgres-admin
          key: postgres-user

    POSTGRES_PASSWORD:
      valueFrom:
        secretKeyRef:
          name: postgres-admin
          key: postgres-password